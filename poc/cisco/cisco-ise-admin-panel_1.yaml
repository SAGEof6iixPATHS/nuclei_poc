id: cisco-ise-admin-panel

info:
  name: Cisco ISE Admin Login Panel - Detect
  author: bhutch
  severity: info
  description: |
    Cisco Identity Services Engine (ISE) admin login panel was discovered.
  metadata:
    verified: true
    max-request: 1
    shodan-query:
      - html:"Identity Services Engine"
      - '"Set-Cookie: APPSESSIONID=" "Path=/admin"'
      - http.favicon.hash:-945076912
      - http.favicon.hash:-12304266
    fofa-query:
      - body="Identity Services Engine"
      - '"Set-Cookie: APPSESSIONID=" && "Path=/admin"'
      - icon_hash="-945076912"
      - icon_hash="-12304266"
    runzero-match: service["http.body"] matches "(?i)Identity Services Engine"
  tags: cisco,ise,admin,login,panel,detect

http:
  - method: GET
    path:
      - "{{BaseURL}}/admin/login.jsp"

    matchers:
      - type: dsl
        dsl:
          - status_code == 200 && contains(body, "document.title =\'Identity Services Engine\';")
          - status_code == 403 && contains(body, "<title>Identity Services Engine</title>")

    extractors:
      - type: regex
        name: extracted_unix_timestamp
        part: body
        regex:
          - "\\?_isever=(\\d{10})"
        group: 1
        internal: true

      - type: dsl
        name: extracted_date
        dsl:
          - "date_time('%Y-%M-%D', extracted_unix_timestamp)"

