id: bitrix-deserialization

info:
  name: Bitrix Deserialization Vulnerabilities
  author: clevergod
  severity: high
  description: |
    Проверка уязвимостей десериализации в Bitrix CMS через различные компоненты
  tags: bitrix,deserialization,object-injection,php

requests:
  # Deserialization в vote компоненте
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/vote.result.new/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      VOTE_ID=1&PARAMS=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-vote
        words:
          - "stdClass"
          - "test"

  # Deserialization в forum компоненте
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/forum.topic.list/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      FID=1&PARAMS=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-forum
        words:
          - "stdClass"
          - "test"

  # Deserialization в blog компоненте
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/blog.post.list/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      BLOG_ID=1&PARAMS=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-blog
        words:
          - "stdClass"
          - "test"

  # Deserialization в catalog компоненте
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/catalog.section.list/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      IBLOCK_ID=1&PARAMS=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-catalog
        words:
          - "stdClass"
          - "test"

  # Deserialization в sale компоненте
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/sale.basket.basket/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      PRODUCT_ID=1&PARAMS=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-sale
        words:
          - "stdClass"
          - "test"

  # Deserialization через html_editor_action
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/tools/html_editor_action.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=save_file&path=/upload/test.php&content=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-html-editor
        words:
          - "stdClass"
          - "test"

  # Deserialization через site_checker
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/tools/site_checker.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=check&site=O:8:"stdClass":1:{s:4:"test";s:4:"test";}
    matchers:
      - type: word
        name: deserialization-site-checker
        words:
          - "stdClass"
          - "test" 