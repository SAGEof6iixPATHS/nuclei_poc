id: bitrix-common-checks

info:
  name: Bitrix Common Exposure Checks
  author: clevergod
  severity: medium
  description: |
    Проверка популярных эндпоинтов Bitrix на наличие CSRF-токена, Debug-инфо, Upload-точек, init.php и др.
  tags: bitrix,exposure,debug,csrf,upload

requests:
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/ajax_bitrix_sessid_get.php"
    matchers:
      - type: word
        name: sessid
        words:
          - "bitrix_sessid"

  - method: GET
    path:
      - "{{BaseURL}}/bitrix/webdav.test/ajax_upload.php"
    matchers:
      - type: status
        name: webdav
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/html_editor_action.php"
    matchers:
      - type: word
        name: html-editor
        words:
          - "bitrix_sessid"

  - method: GET
    path:
      - "{{BaseURL}}/bitrix/php_interface/init.php"
    matchers:
      - type: status
        name: initphp
        status:
          - 200

  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/composite_data.php"
    matchers:
      - type: word
        name: composite
        words:
          - "templateCachedData"
          - "real_frame"