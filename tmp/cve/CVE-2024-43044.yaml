id: jenkins-cve-2024-43044

info:
  name: Jenkins Arbitrary File Read Vulnerability (CVE-2024-43044)
  author: Dhiraj Mishra (@RandomDhiraj)
  severity: critical
  description: |
    Jenkins versions before 2.440, LTS 2.426.3 are potentially vulnerable to CVE-2024-43044,
    which allows arbitrary file read from the controller.
  reference:
    - https://www.jenkins.io/security/advisory/2024-03-27/
    - https://github.com/convisolabs/CVE-2024-43044-jenkins
    - https://blog.convisoappsec.com/en/analysis-of-cve-2024-43044/
  date: 2024-03-27

requests:
  - method: GET
    path:
      - "{{BaseURL}}/"
    headers:
      Host: "{{Hostname}}"
    matchers:
      - type: word
        words:
          - "x-jenkins"
        part: header
        condition: contains
    extractors:
      - type: regex
        name: jenkins_version
        regex:
          - "x-jenkins: (.*)"
        group: 1

    matchers-condition: or
    matchers:
      - type: regex
        name: version_check
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        part: header
        condition: contains
    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    validators:
      - type: status
        status:
          - 200

    payloads:
      - name: version_check
        path: "{{BaseURL}}/"
        method: GET
        headers:
          Host: "{{Hostname}}"
        matchers:
          - type: regex
            name: version
            regex:
              - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
            part: header
            condition: contains
        extractors:
          - type: regex
            name: version
            regex:
              - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
            group: 0

    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    matchers:
      - type: regex
        name: vulnerability
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        condition: contains
        part: header

    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    matchers-condition: or
    matchers:
      - type: regex
        name: vulnerable
        regex:
          - "(\\d+)\\.(\\d+)\\.(\\d+)"
        condition: contains
        part: header
    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    payloads:
      - name: version_check
        path: "{{BaseURL}}/"
        method: GET
        headers:
          Host: "{{Hostname}}"
        matchers:
          - type: regex
            name: version
            regex:
              - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
            part: header
            condition: contains

    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    matchers:
      - type: regex
        name: vulnerability
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        condition: contains
        part: header

    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    matchers:
      - type: regex
        name: vulnerable
        regex:
          - "(\\d+)\\.(\\d+)\\.(\\d+)"
        condition: contains
        part: header
    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0

    matchers:
      - type: regex
        name: vulnerable
        regex:
          - "(\\d+)\\.(\\d+)\\.(\\d+)"
        condition: contains
        part: header
    extractors:
      - type: regex
        name: version
        regex:
          - "x-jenkins: (\\d+)\\.(\\d+)\\.(\\d+)"
        group: 0
