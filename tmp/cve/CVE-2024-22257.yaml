id: CVE-2024-22257

info:
  name: Spring Security AuthenticatedVoter Access Bypass
  author: Abdur Rahman Jamil Chowdhury
  severity: high
  description: |
    Spring Security may allow access bypass when AuthenticatedVoter is used incorrectly, leading to
    broken access control and unauthorized access to sensitive endpoints.
  tags: spring,security,access-control,auth-bypass
  references:
    - https://spring.io/security/cve-2024-22257
    - https://nvd.nist.gov/vuln/detail/CVE-2024-22257

requests:
  - method: GET
    path:
      - "{{BaseURL}}/admin"
      - "{{BaseURL}}/secure"
      - "{{BaseURL}}/dashboard"
    headers:
      Authorization: ""
    matchers:
      - type: word
        words:
          - "Welcome, Admin"
          - "Dashboard"
          - "User Management"
        part: body
      - type: status
        status:
          - 200
