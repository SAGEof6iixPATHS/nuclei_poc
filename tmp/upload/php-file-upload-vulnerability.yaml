id: php-file-upload-vulnerability
info:
  name: File Upload Vulnerability Detection
  author: kaanbicaklar
  severity: critical
  description: Detects insecure file upload mechanisms in PHP files
  tags: php, file-upload
file:
- extensions:
  - php
  matchers:
  - type: regex
    regex:
    - \$_FILES\s*\[.*\]\['tmp_name'\]
    - move_uploaded_file\s*\(
    - is_uploaded_file\s*\(
    - \$_FILES\s*\[.*\]\['name'\]
  extractors:
  - type: regex
    regex:
    - \$_FILES\s*\[.*\]\['tmp_name'\]
    - move_uploaded_file\s*\(
    - is_uploaded_file\s*\(
    - \$_FILES\s*\[.*\]\['name'\]
