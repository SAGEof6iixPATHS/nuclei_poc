id: drupal7-elfinder-rce

info:
  name: Drupal 7 Elfinder - Remote Code Execution
  author: 1337kro
  severity: critical
  description: |
    Identifies Drupal sites with the elfinder library installed, which could be vulnerable to unrestricted file upload through the connector.php file.When this component is detected, the site may be vulnerable to remote code execution attacks via PHP file uploads.This template only detects the presence of the vulnerable component and does not perform any exploitation.
  remediation: |
    Remove the elfinder library if not needed, or implement proper file upload restrictions and input validation. Additionally, consider implementing Web Application Firewall rules to block access to the connector.php file.
  reference:
    - https://github.com/Kro0oz/drupal-7-elfinder
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cwe-id: CWE-434
  metadata:
    verified: true
    vendor: Drupal
    product: Drupal
    fofa-query: app="drupal"
  tags: drupal,elfinder,filemanager,exposure

http:
  - method: GET
    path:
      - "{{BaseURL}}/sites/all/libraries/elfinder/connectors/php/connector.php"

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - '{"cwd":'

      - type: word
        part: content_type
        words:
          - 'application/json'

      - type: status
        status:
          - 200

