id: caimore-default-login

info:
  name: CAIMORE Gateway Default Credentials
  author: pussycat0x
  severity: high
  description: CAIMORE Gateway default login credentials were discovered.
  metadata:
    verified: true
    max-request: 1
    fofa-query: app="CAIMORE-Gateway"
    runzero-match: any(each(service["http.head.wwwAuthentications"]), {# matches '(?i)realm="CaiMore Gateway'})
  tags: ciamore-gateway,default-login

http:
  - raw:
      - |
        GET /index.asp HTTP/1.1
        Host: {{Hostname}}
        Accept-Encoding: gzip, deflate
        Authorization: Basic {{base64(username + ':' + password)}}

    attack: pitchfork
    payloads:
      username:
        - admin
      password:
        - admin

    matchers-condition: and
    matchers:
      - type: word
        part: body
        words:
          - AR9344_GATEWAY

      - type: status
        status:
          - 200

